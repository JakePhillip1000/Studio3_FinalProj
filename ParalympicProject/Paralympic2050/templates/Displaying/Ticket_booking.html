<!DOCTYPE html>
<html>
    <head>
        {% extends "menu.html" %}
        {% block title %}Paralympic2050 (Ticket Booking){% endblock %}

        {% block content %}
        {% load static %}

        {% block css_style %}
            <link rel="stylesheet" href="{% static 'css_file/Ticket_booking.css' %}?v=1.0">
        {% endblock %}
    </head>

<body>
    <!--Banner displaying-->
    <section class = "banner">
        <img src="{% static 'img/banner_img/TB_title.png' %}" alt="Paralympic Logo" width="100%">
    </section>

    <section class = "ticket-header">
        <p>
            - Some sessions might be temporary unavailable for sale: Check for updates on the page. <br/>
            - In December 2050, you will be able to download the ticket app. 
            to access your digital tickets. Through the app, you can also change attendee names.<br/>
            - Seats will be assigned in December 2050, and the QR code for entry will be
            available in the app 24 hours before the sessions start.<br/>
        </p>
    </section>

    <section class="filter-section">
        <button class="filter-btn">Filter</button>

        <label class="switch">
            <input type="checkbox" id="availableToggle">
            <span class="slider"></span>
        </label>
        <p class="available-text">Available to book only</p>
    </section>


    <!-- Filter form. This will appear only when clicked the filter button -->
    <section>
        <div id="filterModal" class="modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h2>Filter</h2>
                    </div>
                    <hr/>

                    <form id="filterForm" method="GET">
                        <div class="form-group">
                            <label for="dateFrom">Date of Competition (From):</label>
                            <input type="date" id="dateFrom" name="date_from">
                        </div>
                        
                        <div class="form-group">
                            <label for="dateTo">Date of Competition (To):</label>
                            <input type="date" id="dateTo" name="date_to">
                        </div>
                        
                        <div class="form-group">
                            <label for="sport">Sport:</label>
                            <input type="text" id="sport" name="sport" placeholder="Enter sport">
                        </div>
                        
                        <div class="form-group">
                            <label>Gender:</label>
                            <div class="radio-group">
                                <input type="radio" id="genderAll" name="gender" value="" checked>
                                <label for="genderAll">All</label>
                                
                                <input type="radio" id="genderMale" name="gender" value="Male">
                                <label for="genderMale">Male</label>
                                
                                <input type="radio" id="genderFemale" name="gender" value="Female">
                                <label for="genderFemale">Female</label>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="classification">Classification:</label>
                            <input type="text" id="classification" name="classification" placeholder="Enter classification">
                        </div>
                        
                        <div class="form-group">
                            <label for="location">Location:</label>
                            <input type="text" id="location" name="location" placeholder="Enter location">
                        </div>
                        
                        <div class="modal-buttons">
                            <button type="button" class="quit-btn">Quit</button>
                            <button type="submit" class="save-btn">Save</button>
                        </div>
                    </form>
                </div>
            </div>
    </section>

    <!--
    This section is the ticket booking form. When clicked the ticket button, 
    the event that not yet concluded, this will show the form
    -->
    <form method="POST" id="ticketForm" action="{% url 'Paralympic2050:ticket' %}">
        {% csrf_token %}
        <input type="hidden" name="event_id" id="currentEventId" value="">

        <section class="ticket-modal-section">
            <div class="ticket-modal" id="ticketModal">
                <div class="ticket-content">
                    <h2>Ticket Details</h2>
                    <hr/>

                    <h3>Category A</h3>
                    <div class="ticket-row">
                        <span>Full Price - Standard</span>
                        <span class="price">50$</span>
                        <input type="number" name="ticket_standard_A" min="0" value="0" data-price="50">
                        <input type="hidden" name="price_standard_A" value="50">
                    </div>

                    <div class="ticket-row">
                        <span>Full Price - with disability/Impairment</span>
                        <span class="price">40$</span>
                        <input type="number" name="ticket_disability_A" min="0" value="0" data-price="40">
                        <input type="hidden" name="price_disability_A" value="40">
                    </div>

                    <div class="ticket-row">
                        <span>Reduced Price - Companion</span>
                        <span class="price">35$</span>
                        <input type="number" name="ticket_companion_A" min="0" value="0" data-price="35">
                        <input type="hidden" name="price_companion_A" value="35">
                    </div>

                    <div class="ticket-row">
                        <span>Reduced Price - Under 14</span>
                        <span class="price">25$</span>
                        <input type="number" name="ticket_under14_A" min="0" value="0" data-price="25">
                        <input type="hidden" name="price_under14_A" value="25">
                    </div>

                    <div class="ticket-row">
                        <span>Reduced Price - Under 14 with disability/Impairment</span>
                        <span class="price">15$</span>
                        <input type="number" name="ticket_under14_disability_A" min="0" value="0" data-price="15">
                        <input type="hidden" name="price_under14_disability_A" value="15">
                    </div>

                    <h3>Category B</h3>
                    <div class="ticket-row">
                        <span>Full Price - Standard</span>
                        <span class="price">40$</span>
                        <input type="number" name="ticket_standard_B" min="0" value="0" data-price="40">
                        <input type="hidden" name="price_standard_B" value="40">
                    </div>

                    <div class="ticket-row">
                        <span>Full Price - with disability/Impairment</span>
                        <span class="price">30$</span>
                        <input type="number" name="ticket_disability_B" min="0" value="0" data-price="30">
                        <input type="hidden" name="price_disability_B" value="30">
                    </div>

                    <div class="ticket-row">
                        <span>Reduced Price - Companion</span>
                        <span class="price">28$</span>
                        <input type="number" name="ticket_companion_B" min="0" value="0" data-price="28">
                        <input type="hidden" name="price_companion_B" value="28">
                    </div>

                    <div class="ticket-row">
                        <span>Reduced Price - Under 14</span>
                        <span class="price">20$</span>
                        <input type="number" name="ticket_under14_B" min="0" value="0" data-price="20">
                        <input type="hidden" name="price_under14_B" value="20">
                    </div>

                    <div class="ticket-row">
                        <span>Reduced Price - Under 14 with disability/Impairment</span>
                        <span class="price">10$</span>
                        <input type="number" name="ticket_under14_disability_B" min="0" value="0" data-price="10">
                        <input type="hidden" name="price_under14_disability_B" value="10">
                    </div>

                    <div class="ticket-footer">
                        <button type="button" class="back-btn">Back</button>
                        <button type="button" class="book-btn">Book the Ticket</button>
                    </div>
                </div>
            </div>
        </section>
    </form>


    <!--
        When the user clicked book ticket inside the ticket details form. This should show
        the ticket confirmation details
    -->
    <div class="ticket-modal" id="confirmationModal">
        <div class="ticket-content">
            <h2>Ticket Confirmation</h2>
            <hr/>

            <div id="confirmationDetails">
                <!--
                    This one, I will use JS to show it
                -->
            </div>

            <div class="total-section">
                <h3>Total</h3>

                <div class="visa-input">
                    <label>Visa: </label>
                    <input type="text" id="visaInput" placeholder="Please Enter Your Visa" maxlength="16">
                </div>

                <div class="total-amount" id="confirmationTotal">0$</div>
            </div>

            <div class="ticket-footer">
                <button class="back-btn" id="confirmBackBtn">Back</button>
                <button class="confirm-btn" id="confirmBtn">Confirm</button>
            </div>
        </div>
    </div>

    <div class="ticket-modal" id="transactionModal">
        <div class="ticket-content">
            <h2>Ticket Details</h2>
            <hr/>

            <h3 style="text-align: center; margin-bottom: 20px;">Ticket Confirmation</h3>
            <hr style="margin-bottom: 20px;"/>

            <h3 style="text-align: center; color: #57db76; margin-bottom: 30px;">Transaction Complete!</h3>

            <div id="transactionDetails">
                <!--
                    For this one, I will note that it is initially hide and 
                    I will use JS to show it
                -->
            </div>

            <div class="ticket-footer" style="justify-content: center;">
                <button class="continue-btn" id="continueBtn">Continue</button>
            </div>
        </div>
    </div>

    <!--This section will show all the events in db-->
    <!--Every new event, the program will create new div element by the method of DTL for loop-->
    <section class="event-list">

        {% for event in events %}
        <div class="event-card" data-event-id="{{ event.id }}">
            
            <!--This will show all the events inside the database-->
            <div class="event-info">
                <span class="sport">{{ event.sport }}</span><br>
                <span class="details">
                    {{ event.gender }} | {{ event.classification }}<br>
                    {{ event.date_time|date:"j M Y, g:i A" }} | {{ event.location }}
                </span>
            </div>

            <!--
            If the event is in progress, this will be available
            However, if the event is cancelled or concluded, the user
            cannot buy a ticket for that event
            -->
            {% if request.session.logged_in_user %}
                {% if event.status == "In Progress" %}
                    <button class="ticket-btn">Ticket</button>
                {% else %}
                    <button class="not-available-btn" disabled>Not<br/>Available</button>
                {% endif %}
            {% endif %}
        </div>  

        <!--If there is no event inside the database-->
        {% empty %}
        <div class="no-event">There is no event available yet</div>

        {% endfor %}
    </section>

    <!-- Load JS at the bottom -->
    <script src="{% static 'js_file/Ticket_booking.js' %}"></script>

    {% endblock %}
</body>
</html>
